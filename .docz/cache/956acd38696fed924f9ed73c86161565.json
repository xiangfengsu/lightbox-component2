{"remainingRequest":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/thread-loader/dist/cjs.js??ref--5-1!/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/babel-loader/lib/index.js??ref--5-2!/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/source-map-loader/index.js!/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/src/components/Image.jsx","dependencies":[{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/src/components/Image.jsx","mtime":1596591443044},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/cache-loader/dist/cjs.js","mtime":1559287157571},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/thread-loader/dist/cjs.js","mtime":1559287161899},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/babel-loader/lib/index.js","mtime":1559287156758},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/source-map-loader/index.js","mtime":1559287161728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy9zdXhpYW5nZmVuZy9Eb2N1bWVudHMvc3V4aWFuZ2ZlbmcvbXlQcm9qZWN0L3JlYWN0LWNvbXBvbmVudC9saWdodGJveC1jb21wb25lbnQyL25vZGVfbW9kdWxlcy9iYWJlbC1wcmVzZXQtcmVhY3QtYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiBmcm9tICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQgZnJvbSAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2Fzc2VydFRoaXNJbml0aWFsaXplZCI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKdmFyIF9qc3hGaWxlTmFtZSA9ICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgZW50ZXJNb2R1bGUgPSAodHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsIDogcmVxdWlyZSgncmVhY3QtaG90LWxvYWRlcicpKS5lbnRlck1vZHVsZTsKICBlbnRlck1vZHVsZSAmJiBlbnRlck1vZHVsZShtb2R1bGUpOwp9KSgpOwoKdmFyIF9fc2lnbmF0dXJlX18gPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWxbImRlZmF1bHQiXS5zaWduYXR1cmUgOiBmdW5jdGlvbiAoYSkgewogIHJldHVybiBhOwp9OwoKaW1wb3J0IFJlYWN0IGZyb20gInJlYWN0IjsKaW1wb3J0IFJlYWN0RE9NIGZyb20gInJlYWN0LWRvbSI7CmltcG9ydCBQcm9wVHlwZXMgZnJvbSAicHJvcC10eXBlcyI7CmltcG9ydCBJbWFnZU1vZGlmaWVycyBmcm9tICIuL0ltYWdlTW9kaWZpZXJzIjsKaW1wb3J0IEljb24gZnJvbSAiLi9JY29uIjsKaW1wb3J0IHsgY29udGFpbnNDbGFzcyB9IGZyb20gIi4vdXRpbHMvY2xhc3NOYW1lcyI7CmltcG9ydCAiLi9JbWFnZS5jc3MiOwp2YXIgWk9PTV9TVEVQID0gMS4xOwp2YXIgX3JlZiA9IFtNYXRoLnBvdyhaT09NX1NURVAsIDMwKSwgTWF0aC5wb3coMSAvIFpPT01fU1RFUCwgMTApXSwKICAgIE1BWF9aT09NX1NJWkUgPSBfcmVmWzBdLAogICAgTUlOX1pPT01fU0laRSA9IF9yZWZbMV07Cgp2YXIgZXh0bmFtZSA9IGZ1bmN0aW9uIGV4dG5hbWUoKSB7CiAgdmFyIHVybCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7CiAgdmFyIHRlbXAgPSB1cmwuc3BsaXQoJy8nKTsKICB2YXIgZmlsZW5hbWUgPSB0ZW1wW3RlbXAubGVuZ3RoIC0gMV07CiAgdmFyIGZpbGVuYW1lV2l0aG91dFN1ZmZpeCA9IGZpbGVuYW1lLnNwbGl0KC8jfFw/LylbMF07CiAgcmV0dXJuICgvXC5bXi4vXFxdKiQvLmV4ZWMoZmlsZW5hbWVXaXRob3V0U3VmZml4KSB8fCBbJyddKVswXTsKfTsgLy8gY29uc3QgcmVncFBkZkhhbmRsZSA9IHRleHQgPT4gL15odHRwcz8uKihwZGZ8UERGKSQvLnRlc3QodGV4dCk7CgoKdmFyIGlzSW1hZ2VVcmwgPSBmdW5jdGlvbiBpc0ltYWdlVXJsKHVybCkgewogIHZhciBleHRlbnNpb24gPSBleHRuYW1lKHVybCk7CgogIGlmICgvXmRhdGE6aW1hZ2VcLy8udGVzdCh1cmwpIHx8IC8od2VicHxzdmd8cG5nfGdpZnxqcGd8anBlZ3xqZmlmfGJtcHxkcGd8aWNvKSQvaS50ZXN0KGV4dGVuc2lvbikpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgaWYgKC9eZGF0YTovLnRlc3QodXJsKSkgewogICAgLy8gb3RoZXIgZmlsZSB0eXBlcyBvZiBiYXNlNjQKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlmIChleHRlbnNpb24pIHsKICAgIC8vIG90aGVyIGZpbGUgdHlwZXMgd2hpY2ggaGF2ZSBleHRlbnNpb24KICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiBmYWxzZTsKfTsKCnZhciByZWdwUGRmSGFuZGxlID0gZnVuY3Rpb24gcmVncFBkZkhhbmRsZSh1cmwpIHsKICB2YXIgZXh0ZW5zaW9uID0gZXh0bmFtZSh1cmwpOwoKICBpZiAoL15kYXRhOmFwcGxpY2F0aW9uXC9wZGYvLnRlc3QodXJsKSB8fCAvKHBkZnxQREYpJC9pLnRlc3QoZXh0ZW5zaW9uKSkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBpZiAoL15kYXRhOi8udGVzdCh1cmwpKSB7CiAgICAvLyBvdGhlciBmaWxlIHR5cGVzIG9mIGJhc2U2NAogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgaWYgKGV4dGVuc2lvbikgewogICAgLy8gb3RoZXIgZmlsZSB0eXBlcyB3aGljaCBoYXZlIGV4dGVuc2lvbgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgcmV0dXJuIHRydWU7Cn07Cgp2YXIgSW1hZ2VDb250ZW50ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkgewogIF9pbmhlcml0cyhJbWFnZUNvbnRlbnQsIF9SZWFjdCRDb21wb25lbnQpOwoKICBmdW5jdGlvbiBJbWFnZUNvbnRlbnQocHJvcHMpIHsKICAgIHZhciBfdGhpczI7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEltYWdlQ29udGVudCk7CgogICAgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKEltYWdlQ29udGVudCkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF90aGlzMi5yZW5kZXJQREYgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzcmMgPSBfdGhpczIucHJvcHMuc3JjOwogICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBoZWlnaHQ6ICIxMDAlIgogICAgICAgIH0sCiAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsKICAgICAgICAgIF9faHRtbDogIjxlbWJlZCBzcmM9Ii5jb25jYXQoc3JjLCAiIHR5cGU9XCJhcHBsaWNhdGlvbi9wZGZcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCI+IikKICAgICAgICB9LAogICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgbGluZU51bWJlcjogMzEwCiAgICAgICAgfSwKICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgfSk7CiAgICB9OwoKICAgIF90aGlzMi5yZXNldEltYWdlSW5pdGlhbFN0YXRlID0gX3RoaXMyLnJlc2V0SW1hZ2VJbml0aWFsU3RhdGUuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLmhhbmRsZVdpbmRvd1Jlc2l6ZSA9IF90aGlzMi5oYW5kbGVXaW5kb3dSZXNpemUuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLmhhbmRsZVJvdGF0ZSA9IF90aGlzMi5oYW5kbGVSb3RhdGUuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLmhhbmRsZVpvb20gPSBfdGhpczIuaGFuZGxlWm9vbS5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSk7CiAgICBfdGhpczIuc2V0Wm9vbUxpbWl0cyA9IF90aGlzMi5zZXRab29tTGltaXRzLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5oYW5kbGVXaGVlbCA9IF90aGlzMi5oYW5kbGVXaGVlbC5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSk7CiAgICBfdGhpczIuaGFuZGxlTW92ZSA9IF90aGlzMi5oYW5kbGVNb3ZlLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5oYW5kbGVNb3ZlRW5kID0gX3RoaXMyLmhhbmRsZU1vdmVFbmQuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLmhhbmRsZU1vdmVTdGFydCA9IF90aGlzMi5oYW5kbGVNb3ZlU3RhcnQuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLmlzSW5zaWRlSW1hZ2UgPSBfdGhpczIuaXNJbnNpZGVJbWFnZS5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSk7CiAgICBfdGhpczIuc3RhdGUgPSB7CiAgICAgIGxvYWRlcjogdHJ1ZSwKICAgICAgcmF0aW86IDEsCiAgICAgIHBvc2l0aW9uWDogMCwKICAgICAgcG9zaXRpb25ZOiAwLAogICAgICByb3RhdGU6IDAsCiAgICAgIHdpZHRoOiAwLAogICAgICBoZWlnaHQ6IDAsCiAgICAgIGJveFdpZHRoOiAwLAogICAgICBib3hIZWlnaHQ6IDAKICAgIH07CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEltYWdlQ29udGVudCwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5yZXNldEltYWdlSW5pdGlhbFN0YXRlKHRoaXMucHJvcHMpOwogICAgICB0aGlzLnN0YXJ0UG9pbnRzID0gbnVsbDsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHRoaXMuaGFuZGxlV2luZG93UmVzaXplKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgdGhpcy5oYW5kbGVNb3ZlU3RhcnQpOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgdGhpcy5oYW5kbGVNb3ZlRW5kKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hzdGFydCIsIHRoaXMuaGFuZGxlTW92ZVN0YXJ0KTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hlbmQiLCB0aGlzLmhhbmRsZU1vdmVFbmQpOwogICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzLnByb3BzLnRvZ2dsZUNvbnRyb2xzLCA1MDApOwoKICAgICAgaWYgKHRoaXMucHJvcHMuc2hvd0ltYWdlTW9kaWZpZXJzKSB7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIiwgdGhpcy5oYW5kbGVNb3ZlKTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLCB0aGlzLmhhbmRsZU1vdmUpOwogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIndoZWVsIiwgdGhpcy5oYW5kbGVXaGVlbCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJyZXNpemUiLCB0aGlzLmhhbmRsZVdpbmRvd1Jlc2l6ZSk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHRoaXMuaGFuZGxlTW92ZVN0YXJ0KTsKICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIiwgdGhpcy5oYW5kbGVNb3ZlKTsKICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2V1cCIsIHRoaXMuaGFuZGxlTW92ZUVuZCk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCB0aGlzLmhhbmRsZU1vdmVTdGFydCk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsIHRoaXMuaGFuZGxlTW92ZSk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNoZW5kIiwgdGhpcy5oYW5kbGVNb3ZlRW5kKTsKICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2hlZWwiLCB0aGlzLmhhbmRsZVdoZWVsKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNldEltYWdlSW5pdGlhbFN0YXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldEltYWdlSW5pdGlhbFN0YXRlKHByb3BzKSB7CiAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfcmVmMiA9IFt0aGlzLndpZHRoLCB0aGlzLmhlaWdodF0sCiAgICAgICAgICAgIHdpZHRoID0gX3JlZjJbMF0sCiAgICAgICAgICAgIGhlaWdodCA9IF9yZWYyWzFdOwogICAgICAgIHZhciBib3ggPSBSZWFjdERPTS5maW5kRE9NTm9kZShfdGhpcy5yZWZzLmNvbnRhaW5lcik7CiAgICAgICAgdmFyIF9yZWYzID0gW2JveC5vZmZzZXRXaWR0aCwgYm94Lm9mZnNldEhlaWdodF0sCiAgICAgICAgICAgIGJveFdpZHRoID0gX3JlZjNbMF0sCiAgICAgICAgICAgIGJveEhlaWdodCA9IF9yZWYzWzFdOwogICAgICAgIHZhciByYXRpbyA9IE1hdGgubWluKGJveFdpZHRoIC8gd2lkdGgsIGJveEhlaWdodCAvIGhlaWdodCk7CiAgICAgICAgaWYgKGlzTmFOKHJhdGlvKSkgcmF0aW8gPSAxOwoKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBsb2FkZXI6IGZhbHNlLAogICAgICAgICAgcmF0aW86IHJhdGlvLAogICAgICAgICAgcm90YXRlOiAwLAogICAgICAgICAgcG9zaXRpb25YOiAoYm94V2lkdGggLSB3aWR0aCAqIHJhdGlvKSAvIDIsCiAgICAgICAgICBwb3NpdGlvblk6IChib3hIZWlnaHQgLSBoZWlnaHQgKiByYXRpbykgLyAyLAogICAgICAgICAgd2lkdGg6IHRoaXMud2lkdGgsCiAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0LAogICAgICAgICAgYm94V2lkdGg6IGJveFdpZHRoLAogICAgICAgICAgYm94SGVpZ2h0OiBib3hIZWlnaHQsCiAgICAgICAgICBtb3Zpbmc6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICBpbWcuc3JjID0gcHJvcHMuc3JjOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZVdpbmRvd1Jlc2l6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlV2luZG93UmVzaXplKCkgewogICAgICB0aGlzLnJlc2V0SW1hZ2VJbml0aWFsU3RhdGUodGhpcy5wcm9wcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFuZGxlUm90YXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVSb3RhdGUoYW5nbGUpIHsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcm90YXRlOiAoMzYwICsgdGhpcy5zdGF0ZS5yb3RhdGUgKyBhbmdsZSkgJSAzNjAKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFuZGxlWm9vbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlWm9vbShkaXJlY3Rpb24sIHNjYWxlKSB7CiAgICAgIGlmICghc2NhbGUpIHNjYWxlID0gMTsKICAgICAgdmFyIHBlcmNlbnQgPSBkaXJlY3Rpb24gPiAwID8gTWF0aC5wb3coWk9PTV9TVEVQLCBzY2FsZSkgOiBNYXRoLnBvdygxIC8gWk9PTV9TVEVQLCBzY2FsZSk7CiAgICAgIHZhciByYXRpbyA9IHRoaXMuc2V0Wm9vbUxpbWl0cyh0aGlzLnN0YXRlLnJhdGlvICogcGVyY2VudCk7CiAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGU7CiAgICAgIHZhciBkZWx0YSA9IDAuMDU7CiAgICAgIHZhciBuZXdQb3NpdGlvblgsIG5ld1Bvc2l0aW9uWTsKCiAgICAgIGlmIChNYXRoLm1pbihzdGF0ZS5ib3hXaWR0aCAvIHN0YXRlLndpZHRoLCBzdGF0ZS5ib3hIZWlnaHQgLyBzdGF0ZS5oZWlnaHQpID49IHJhdGlvIC0gZGVsdGEpIHsKICAgICAgICBuZXdQb3NpdGlvblggPSAoc3RhdGUuYm94V2lkdGggLSBzdGF0ZS53aWR0aCAqIHJhdGlvKSAvIDI7CiAgICAgICAgbmV3UG9zaXRpb25ZID0gKHN0YXRlLmJveEhlaWdodCAtIHN0YXRlLmhlaWdodCAqIHJhdGlvKSAvIDI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQ2VudGVyIGltYWdlIGZyb20gY29udGFpbmVyJ3MgY2VudGVyCiAgICAgICAgdmFyIG9mZnNldFggPSBzdGF0ZS5ib3hXaWR0aCAvIDI7CiAgICAgICAgdmFyIG9mZnNldFkgPSBzdGF0ZS5ib3hIZWlnaHQgLyAyOwogICAgICAgIHZhciBiZ0N1cnNvclggPSBvZmZzZXRYIC0gc3RhdGUucG9zaXRpb25YOwogICAgICAgIHZhciBiZ0N1cnNvclkgPSBvZmZzZXRZIC0gc3RhdGUucG9zaXRpb25ZOwogICAgICAgIHZhciBiZ1JhdGlvWCA9IGJnQ3Vyc29yWCAvIChzdGF0ZS53aWR0aCAqIHN0YXRlLnJhdGlvKTsKICAgICAgICB2YXIgYmdSYXRpb1kgPSBiZ0N1cnNvclkgLyAoc3RhdGUuaGVpZ2h0ICogc3RhdGUucmF0aW8pOwogICAgICAgIG5ld1Bvc2l0aW9uWCA9IG9mZnNldFggLSBzdGF0ZS53aWR0aCAqIHJhdGlvICogYmdSYXRpb1g7CiAgICAgICAgbmV3UG9zaXRpb25ZID0gb2Zmc2V0WSAtIHN0YXRlLmhlaWdodCAqIHJhdGlvICogYmdSYXRpb1k7CiAgICAgIH0KCiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHJhdGlvOiByYXRpbywKICAgICAgICBwb3NpdGlvblg6IG5ld1Bvc2l0aW9uWCwKICAgICAgICBwb3NpdGlvblk6IG5ld1Bvc2l0aW9uWQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRab29tTGltaXRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRab29tTGltaXRzKHNpemUpIHsKICAgICAgdmFyIHN0YXRlID0gdGhpcy5zdGF0ZTsKICAgICAgdmFyIG9yaWdpbmFsUmF0aW8gPSBNYXRoLm1pbihzdGF0ZS5ib3hXaWR0aCAvIHN0YXRlLndpZHRoLCBzdGF0ZS5ib3hIZWlnaHQgLyBzdGF0ZS5oZWlnaHQpOwogICAgICBpZiAoc2l6ZSAvIG9yaWdpbmFsUmF0aW8gPiBNQVhfWk9PTV9TSVpFKSByZXR1cm4gTUFYX1pPT01fU0laRSAqIG9yaWdpbmFsUmF0aW87ZWxzZSBpZiAoc2l6ZSAvIG9yaWdpbmFsUmF0aW8gPCBNSU5fWk9PTV9TSVpFKSByZXR1cm4gTUlOX1pPT01fU0laRSAqIG9yaWdpbmFsUmF0aW87ZWxzZSByZXR1cm4gc2l6ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVXaGVlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlV2hlZWwoZXYpIHsKICAgICAgaWYgKHRoaXMuaXNJbnNpZGVJbWFnZShldikpIHRoaXMuaGFuZGxlWm9vbShldi5kZWx0YVkpOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZU1vdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZU1vdmUoZXYpIHsKICAgICAgZXYgPSB0aGlzLmdldEV2KGV2KTsKICAgICAgdmFyIHN0YXRlID0gdGhpcy5zdGF0ZTsKICAgICAgaWYgKCFzdGF0ZS5tb3ZpbmcpIHJldHVybjsKICAgICAgdmFyIHBvc1gsIHBvc1k7CgogICAgICBzd2l0Y2ggKHN0YXRlLnJvdGF0ZSkgewogICAgICAgIGNhc2UgOTA6CiAgICAgICAgICBwb3NZID0gdGhpcy5zdGFydFBvaW50c1swXSAtIGV2LnBhZ2VYOwogICAgICAgICAgcG9zWCA9IGV2LnBhZ2VZIC0gdGhpcy5zdGFydFBvaW50c1sxXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE4MDoKICAgICAgICAgIHBvc1ggPSB0aGlzLnN0YXJ0UG9pbnRzWzBdIC0gZXYucGFnZVg7CiAgICAgICAgICBwb3NZID0gdGhpcy5zdGFydFBvaW50c1sxXSAtIGV2LnBhZ2VZOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjcwOgogICAgICAgICAgcG9zWSA9IGV2LnBhZ2VYIC0gdGhpcy5zdGFydFBvaW50c1swXTsKICAgICAgICAgIHBvc1ggPSB0aGlzLnN0YXJ0UG9pbnRzWzFdIC0gZXYucGFnZVk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHBvc1ggPSBldi5wYWdlWCAtIHRoaXMuc3RhcnRQb2ludHNbMF07CiAgICAgICAgICBwb3NZID0gZXYucGFnZVkgLSB0aGlzLnN0YXJ0UG9pbnRzWzFdOwogICAgICB9CgogICAgICB0aGlzLnN0YXJ0UG9pbnRzID0gW2V2LnBhZ2VYLCBldi5wYWdlWV07CiAgICAgIGlmIChzdGF0ZS5wb3NpdGlvblggKyBwb3NYID49IDAgfHwgc3RhdGUucG9zaXRpb25YICsgcG9zWCA8PSBzdGF0ZS5ib3hXaWR0aCAtIHN0YXRlLndpZHRoICogc3RhdGUucmF0aW8pIHBvc1ggPSAwOwogICAgICBpZiAoc3RhdGUucG9zaXRpb25ZICsgcG9zWSA+PSAwIHx8IHN0YXRlLnBvc2l0aW9uWSArIHBvc1kgPD0gc3RhdGUuYm94SGVpZ2h0IC0gc3RhdGUuaGVpZ2h0ICogc3RhdGUucmF0aW8pIHBvc1kgPSAwOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBwb3NpdGlvblg6IHN0YXRlLnBvc2l0aW9uWCArIHBvc1gsCiAgICAgICAgcG9zaXRpb25ZOiBzdGF0ZS5wb3NpdGlvblkgKyBwb3NZCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZU1vdmVFbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZU1vdmVFbmQoZXYpIHsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgbW92aW5nOiBmYWxzZQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVNb3ZlU3RhcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZU1vdmVTdGFydChldikgewogICAgICBldiA9IHRoaXMuZ2V0RXYoZXYpOwogICAgICBpZiAoIXRoaXMuaXNJbnNpZGVJbWFnZShldikgfHwgZXYud2hpY2ggIT09IDEpIHJldHVybjsKICAgICAgdGhpcy5zdGFydFBvaW50cyA9IFtldi5wYWdlWCwgZXYucGFnZVldOwogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICBtb3Zpbmc6IHRydWUKICAgICAgfSk7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOyAvLyBjaGVjayBpZiB0b3VjaCB3YXMgYSB0YXAKCgogICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFfdGhpcy5zdGF0ZS5tb3ZpbmcgJiYgX3RoaXMuc3RhcnRQb2ludHMgJiYgX3RoaXMuc3RhcnRQb2ludHNbMF0gPT09IGV2LnBhZ2VYICYmIF90aGlzLnN0YXJ0UG9pbnRzWzFdID09PSBldi5wYWdlWSAmJiBjb250YWluc0NsYXNzKGV2LnRhcmdldCwgWyJsaWdodGJveC1iYWNrZHJvcCIsICJsaWdodGJveC1pbWFnZSJdKSkgewogICAgICAgICAgX3RoaXMucHJvcHMudG9nZ2xlQ29udHJvbHMoKTsKICAgICAgICB9CiAgICAgIH0sIDIwMCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNJbnNpZGVJbWFnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNJbnNpZGVJbWFnZShldikgewogICAgICB2YXIgcmVjdCA9IFJlYWN0RE9NLmZpbmRET01Ob2RlKHRoaXMucmVmcy5jb250YWluZXIpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBpZiAoZXYucGFnZVkgPCByZWN0LnRvcCB8fCBldi5wYWdlWSA+IHJlY3QuYm90dG9tIHx8IGV2LnBhZ2VYIDwgcmVjdC5sZWZ0IHx8IGV2LnBhZ2VYID4gcmVjdC5yaWdodCkgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRFdiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RXYoZXYpIHsKICAgICAgaWYgKGV2LnR5cGUgPT09ICJ0b3VjaHN0YXJ0IiB8fCBldi50eXBlID09PSAidG91Y2htb3ZlIiB8fCBldi50eXBlID09PSAidG91Y2hlbmQiKSByZXR1cm4gewogICAgICAgIHBhZ2VYOiBldi50b3VjaGVzWzBdLnBhZ2VYLAogICAgICAgIHBhZ2VZOiBldi50b3VjaGVzWzBdLnBhZ2VZLAogICAgICAgIHdoaWNoOiAxLAogICAgICAgIHRhcmdldDogZXYudGFyZ2V0CiAgICAgIH07CiAgICAgIHJldHVybiBldjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF9yZWY0ID0gW3RoaXMucHJvcHMsIHRoaXMuc3RhdGVdLAogICAgICAgICAgcHJvcHMgPSBfcmVmNFswXSwKICAgICAgICAgIHN0YXRlID0gX3JlZjRbMV07CiAgICAgIHZhciBiYWNrZ3JvdW5kID0gInVybCgiLmNvbmNhdChwcm9wcy5zcmMsICIpIik7CiAgICAgIHZhciBtb2RpZmllcnMsIGxvYWRlcjsKCiAgICAgIGlmIChwcm9wcy5zaG93SW1hZ2VNb2RpZmllcnMpIHsKICAgICAgICBtb2RpZmllcnMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KEltYWdlTW9kaWZpZXJzLCB7CiAgICAgICAgICBoYW5kbGVSb3RhdGU6IHRoaXMuaGFuZGxlUm90YXRlLAogICAgICAgICAgaGFuZGxlWm9vbTogdGhpcy5oYW5kbGVab29tLAogICAgICAgICAgY3VycmVudEltYWdlOiBwcm9wcy5zcmMsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiAzMjUKICAgICAgICAgIH0sCiAgICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHN0YXRlLmxvYWRlcikgewogICAgICAgIGJhY2tncm91bmQgPSAibm9uZSI7CiAgICAgICAgbG9hZGVyID0gUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAibGlnaHRib3gtbG9hZGVyIiwKICAgICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICAgIGxpbmVOdW1iZXI6IDMzNQogICAgICAgICAgfSwKICAgICAgICAgIF9fc2VsZjogdGhpcwogICAgICAgIH0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoSWNvbiwgewogICAgICAgICAgaWNvbjogInNwaW5uZXIiLAogICAgICAgICAgc2l6ZTogNTgsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiAzMzYKICAgICAgICAgIH0sCiAgICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgICB9KSk7CiAgICAgIH0gLy8gY29uc3QgY3VzdG9tQ29udGVudCA9IHByb3BzLmN1c3RvbUNvbnRlbnQgPyBwcm9wcy5jdXN0b21Db250ZW50IDogbnVsbDsKCgogICAgICB2YXIgdHJhbnNmb3JtID0gInJvdGF0ZSgiLmNvbmNhdChzdGF0ZS5yb3RhdGUsICJkZWcpIik7CiAgICAgIHZhciBzdHlsZXMgPSB7CiAgICAgICAgaGVpZ2h0OiAiMTAwJSIsCiAgICAgICAgYmFja2dyb3VuZEltYWdlOiBpc0ltYWdlVXJsKHByb3BzLnNyYykgPyBiYWNrZ3JvdW5kIDogIm5vbmUiLAogICAgICAgIGJhY2tncm91bmRSZXBlYXQ6ICJuby1yZXBlYXQiLAogICAgICAgIGJhY2tncm91bmRTaXplOiAiIi5jb25jYXQoc3RhdGUud2lkdGggKiBzdGF0ZS5yYXRpbywgInB4ICIpLmNvbmNhdChzdGF0ZS5oZWlnaHQgKiBzdGF0ZS5yYXRpbywgInB4IiksCiAgICAgICAgYmFja2dyb3VuZFBvc2l0aW9uOiAiIi5jb25jYXQoc3RhdGUucG9zaXRpb25YLCAicHggIikuY29uY2F0KHN0YXRlLnBvc2l0aW9uWSwgInB4IiksCiAgICAgICAgTXNUcmFuc2Zvcm06IHRyYW5zZm9ybSwKICAgICAgICBXZWJraXRUcmFuc2Zvcm06IHRyYW5zZm9ybSwKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zZm9ybQogICAgICB9OwogICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImxpZ2h0Ym94LWNvbnRlbnQtY2VudGVyIiwKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDM1OAogICAgICAgIH0sCiAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgIH0sIG1vZGlmaWVycywgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImxpZ2h0Ym94LWltYWdlLWNvbnRhaW5lciIsCiAgICAgICAgcmVmOiAiY29udGFpbmVyIiwKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDM2MAogICAgICAgIH0sCiAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgIH0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJsaWdodGJveC1pbWFnZSIgKyAoc3RhdGUubW92aW5nID8gIiBtb3ZpbmciIDogIiIpLAogICAgICAgIHN0eWxlOiBzdHlsZXMsCiAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICBsaW5lTnVtYmVyOiAzNjEKICAgICAgICB9LAogICAgICAgIF9fc2VsZjogdGhpcwogICAgICB9LCByZWdwUGRmSGFuZGxlKHByb3BzLnNyYykgPyB0aGlzLnJlbmRlclBERigpIDogIuaWh+S7tuagvOW8j+aXoOazleWxleekuiIpKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX19yZWFjdHN0YW5kaW5fX3JlZ2VuZXJhdGVCeUV2YWwiLAogICAgLy8gQHRzLWlnbm9yZQogICAgdmFsdWU6IGZ1bmN0aW9uIF9fcmVhY3RzdGFuZGluX19yZWdlbmVyYXRlQnlFdmFsKGtleSwgY29kZSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHRoaXNba2V5XSA9IGV2YWwoY29kZSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSW1hZ2VDb250ZW50Owp9KFJlYWN0LkNvbXBvbmVudCk7CgpleHBvcnQgeyBJbWFnZUNvbnRlbnQgYXMgZGVmYXVsdCB9OwoKaWYgKHR5cGVvZiBJbWFnZUNvbnRlbnQgIT09ICd1bmRlZmluZWQnICYmIEltYWdlQ29udGVudCAmJiBJbWFnZUNvbnRlbnQgPT09IE9iamVjdChJbWFnZUNvbnRlbnQpICYmIE9iamVjdC5pc0V4dGVuc2libGUoSW1hZ2VDb250ZW50KSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUNvbnRlbnQsICdfX2ZpbGVtZXRhJywgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiB7CiAgICAgIG5hbWU6ICJJbWFnZUNvbnRlbnQiLAogICAgICBmaWxlbmFtZTogInNyYy9jb21wb25lbnRzL0ltYWdlLmpzeCIKICAgIH0KICB9KTsKfQoKaWYgKHR5cGVvZiBJbWFnZUNvbnRlbnQgIT09ICd1bmRlZmluZWQnICYmIEltYWdlQ29udGVudCAmJiBJbWFnZUNvbnRlbnQgPT09IE9iamVjdChJbWFnZUNvbnRlbnQpICYmIE9iamVjdC5pc0V4dGVuc2libGUoSW1hZ2VDb250ZW50KSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUNvbnRlbnQsICdfX2ZpbGVtZXRhJywgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiB7CiAgICAgIG5hbWU6ICJJbWFnZUNvbnRlbnQiLAogICAgICBmaWxlbmFtZTogInNyYy9jb21wb25lbnRzL0ltYWdlLmpzeCIKICAgIH0KICB9KTsKfQoKSW1hZ2UucHJvcFR5cGVzID0gewogIHNyYzogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLAogIHNob3dJbWFnZU1vZGlmaWVyczogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZAp9Owo7CgooZnVuY3Rpb24gKCkgewogIHZhciByZWFjdEhvdExvYWRlciA9ICh0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwgOiByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykpLmRlZmF1bHQ7CgogIGlmICghcmVhY3RIb3RMb2FkZXIpIHsKICAgIHJldHVybjsKICB9CgogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKFpPT01fU1RFUCwgIlpPT01fU1RFUCIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihNQVhfWk9PTV9TSVpFLCAiTUFYX1pPT01fU0laRSIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihNSU5fWk9PTV9TSVpFLCAiTUlOX1pPT01fU0laRSIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihleHRuYW1lLCAiZXh0bmFtZSIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3Rlcihpc0ltYWdlVXJsLCAiaXNJbWFnZVVybCIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihyZWdwUGRmSGFuZGxlLCAicmVncFBkZkhhbmRsZSIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihJbWFnZUNvbnRlbnQsICJJbWFnZUNvbnRlbnQiLCAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvc3JjL2NvbXBvbmVudHMvSW1hZ2UuanN4Iik7Cn0pKCk7Cgo7CgooZnVuY3Rpb24gKCkgewogIHZhciBsZWF2ZU1vZHVsZSA9ICh0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwgOiByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykpLmxlYXZlTW9kdWxlOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/src/components/Image.jsx"],"names":["React","ReactDOM","PropTypes","ImageModifiers","Icon","containsClass","ZOOM_STEP","Math","pow","MAX_ZOOM_SIZE","MIN_ZOOM_SIZE","extname","url","temp","split","filename","length","filenameWithoutSuffix","exec","isImageUrl","extension","test","regpPdfHandle","ImageContent","props","renderPDF","src","height","__html","resetImageInitialState","bind","handleWindowResize","handleRotate","handleZoom","setZoomLimits","handleWheel","handleMove","handleMoveEnd","handleMoveStart","isInsideImage","state","loader","ratio","positionX","positionY","rotate","width","boxWidth","boxHeight","startPoints","window","addEventListener","document","setTimeout","toggleControls","showImageModifiers","removeEventListener","img","Image","_this","onload","box","findDOMNode","refs","container","offsetWidth","offsetHeight","min","isNaN","setState","moving","angle","direction","scale","percent","delta","newPositionX","newPositionY","offsetX","offsetY","bgCursorX","bgCursorY","bgRatioX","bgRatioY","size","originalRatio","ev","deltaY","getEv","posX","posY","pageX","pageY","which","target","rect","getBoundingClientRect","top","bottom","left","right","type","touches","background","modifiers","transform","styles","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition","MsTransform","WebkitTransform","Component","propTypes","string","isRequired","bool"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport ImageModifiers from \"./ImageModifiers\";\nimport Icon from \"./Icon\";\nimport { containsClass } from \"./utils/classNames\";\nimport \"./Image.css\";\n\nconst ZOOM_STEP = 1.1;\nconst [MAX_ZOOM_SIZE, MIN_ZOOM_SIZE] = [\n  Math.pow(ZOOM_STEP, 30),\n  Math.pow(1 / ZOOM_STEP, 10)\n];\n\n\n\nconst extname = (url = '') => {\n  const temp = url.split('/');\n  const filename = temp[temp.length - 1];\n  const filenameWithoutSuffix = filename.split(/#|\\?/)[0];\n  return (/\\.[^./\\\\]*$/.exec(filenameWithoutSuffix) || [''])[0];\n};\n\n// const regpPdfHandle = text => /^https?.*(pdf|PDF)$/.test(text);\n\nconst isImageUrl = (url) => {\n  const extension = extname(url);\n  if (\n    /^data:image\\//.test(url) ||\n    /(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico)$/i.test(extension)\n  ) {\n    return true;\n  }\n  if (/^data:/.test(url)) {\n    // other file types of base64\n    return false;\n  }\n  if (extension) {\n    // other file types which have extension\n    return false;\n  }\n  return false;\n};\n\nconst regpPdfHandle = (url) => {\n  const extension = extname(url);\n  if (\n    /^data:application\\/pdf/.test(url) ||\n    /(pdf|PDF)$/i.test(extension)\n  ) {\n    return true;\n  }\n  if (/^data:/.test(url)) {\n    // other file types of base64\n    return false;\n  }\n  if (extension) {\n    // other file types which have extension\n    return false;\n  }\n  return true;\n};\n\nexport default class ImageContent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.resetImageInitialState = this.resetImageInitialState.bind(this);\n    this.handleWindowResize = this.handleWindowResize.bind(this);\n    this.handleRotate = this.handleRotate.bind(this);\n    this.handleZoom = this.handleZoom.bind(this);\n    this.setZoomLimits = this.setZoomLimits.bind(this);\n    this.handleWheel = this.handleWheel.bind(this);\n    this.handleMove = this.handleMove.bind(this);\n    this.handleMoveEnd = this.handleMoveEnd.bind(this);\n    this.handleMoveStart = this.handleMoveStart.bind(this);\n    this.isInsideImage = this.isInsideImage.bind(this);\n    this.state = {\n      loader: true,\n      ratio: 1,\n      positionX: 0,\n      positionY: 0,\n      rotate: 0,\n      width: 0,\n      height: 0,\n      boxWidth: 0,\n      boxHeight: 0\n    };\n  }\n\n  componentDidMount() {\n    this.resetImageInitialState(this.props);\n    this.startPoints = null;\n    window.addEventListener(\"resize\", this.handleWindowResize);\n    document.addEventListener(\"mousedown\", this.handleMoveStart);\n    document.addEventListener(\"mouseup\", this.handleMoveEnd);\n    document.addEventListener(\"touchstart\", this.handleMoveStart);\n    document.addEventListener(\"touchend\", this.handleMoveEnd);\n    window.setTimeout(this.props.toggleControls, 500);\n    if (this.props.showImageModifiers) {\n      document.addEventListener(\"mousemove\", this.handleMove);\n      document.addEventListener(\"touchmove\", this.handleMove);\n      document.addEventListener(\"wheel\", this.handleWheel);\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.handleWindowResize);\n    document.removeEventListener(\"mousedown\", this.handleMoveStart);\n    document.removeEventListener(\"mousemove\", this.handleMove);\n    document.removeEventListener(\"mouseup\", this.handleMoveEnd);\n    document.removeEventListener(\"touchstart\", this.handleMoveStart);\n    document.removeEventListener(\"touchmove\", this.handleMove);\n    document.removeEventListener(\"touchend\", this.handleMoveEnd);\n    document.removeEventListener(\"wheel\", this.handleWheel);\n  }\n\n  resetImageInitialState(props) {\n    let img = new Image();\n    let _this = this;\n    img.onload = function() {\n      let [width, height] = [this.width, this.height];\n      let box = ReactDOM.findDOMNode(_this.refs.container);\n      let [boxWidth, boxHeight] = [box.offsetWidth, box.offsetHeight];\n      let ratio = Math.min(boxWidth / width, boxHeight / height);\n      if (isNaN(ratio)) ratio = 1;\n      _this.setState({\n        loader: false,\n        ratio: ratio,\n        rotate: 0,\n        positionX: (boxWidth - width * ratio) / 2,\n        positionY: (boxHeight - height * ratio) / 2,\n        width: this.width,\n        height: this.height,\n        boxWidth: boxWidth,\n        boxHeight: boxHeight,\n        moving: false\n      });\n    };\n    img.src = props.src;\n  }\n\n  handleWindowResize() {\n    this.resetImageInitialState(this.props);\n  }\n\n  handleRotate(angle) {\n    this.setState({\n      rotate: (360 + this.state.rotate + angle) % 360\n    });\n  }\n\n  handleZoom(direction, scale) {\n    if (!scale) scale = 1;\n    let percent =\n      direction > 0\n        ? Math.pow(ZOOM_STEP, scale)\n        : Math.pow(1 / ZOOM_STEP, scale);\n    let ratio = this.setZoomLimits(this.state.ratio * percent);\n    let state = this.state;\n    let delta = 0.05;\n    let newPositionX, newPositionY;\n\n    if (\n      Math.min(state.boxWidth / state.width, state.boxHeight / state.height) >=\n      ratio - delta\n    ) {\n      newPositionX = (state.boxWidth - state.width * ratio) / 2;\n      newPositionY = (state.boxHeight - state.height * ratio) / 2;\n    } else {\n      // Center image from container's center\n      let offsetX = state.boxWidth / 2;\n      let offsetY = state.boxHeight / 2;\n\n      let bgCursorX = offsetX - state.positionX;\n      let bgCursorY = offsetY - state.positionY;\n\n      let bgRatioX = bgCursorX / (state.width * state.ratio);\n      let bgRatioY = bgCursorY / (state.height * state.ratio);\n\n      newPositionX = offsetX - state.width * ratio * bgRatioX;\n      newPositionY = offsetY - state.height * ratio * bgRatioY;\n    }\n\n    this.setState({\n      ratio: ratio,\n      positionX: newPositionX,\n      positionY: newPositionY\n    });\n  }\n\n  setZoomLimits(size) {\n    let state = this.state;\n    let originalRatio = Math.min(\n      state.boxWidth / state.width,\n      state.boxHeight / state.height\n    );\n    if (size / originalRatio > MAX_ZOOM_SIZE)\n      return MAX_ZOOM_SIZE * originalRatio;\n    else if (size / originalRatio < MIN_ZOOM_SIZE)\n      return MIN_ZOOM_SIZE * originalRatio;\n    else return size;\n  }\n\n  handleWheel(ev) {\n    if (this.isInsideImage(ev)) this.handleZoom(ev.deltaY);\n  }\n\n  handleMove(ev) {\n    ev = this.getEv(ev);\n    let state = this.state;\n    if (!state.moving) return;\n    let posX, posY;\n    switch (state.rotate) {\n      case 90:\n        posY = this.startPoints[0] - ev.pageX;\n        posX = ev.pageY - this.startPoints[1];\n        break;\n      case 180:\n        posX = this.startPoints[0] - ev.pageX;\n        posY = this.startPoints[1] - ev.pageY;\n        break;\n      case 270:\n        posY = ev.pageX - this.startPoints[0];\n        posX = this.startPoints[1] - ev.pageY;\n        break;\n      default:\n        posX = ev.pageX - this.startPoints[0];\n        posY = ev.pageY - this.startPoints[1];\n    }\n    this.startPoints = [ev.pageX, ev.pageY];\n\n    if (\n      state.positionX + posX >= 0 ||\n      state.positionX + posX <= state.boxWidth - state.width * state.ratio\n    )\n      posX = 0;\n    if (\n      state.positionY + posY >= 0 ||\n      state.positionY + posY <= state.boxHeight - state.height * state.ratio\n    )\n      posY = 0;\n\n    this.setState({\n      positionX: state.positionX + posX,\n      positionY: state.positionY + posY\n    });\n  }\n\n  handleMoveEnd(ev) {\n    this.setState({\n      moving: false\n    });\n  }\n\n  handleMoveStart(ev) {\n    ev = this.getEv(ev);\n    if (!this.isInsideImage(ev) || ev.which !== 1) return;\n    this.startPoints = [ev.pageX, ev.pageY];\n    this.setState({\n      moving: true\n    });\n    const _this = this;\n\n    // check if touch was a tap\n    window.setTimeout(function() {\n      if (\n        !_this.state.moving &&\n        _this.startPoints &&\n        _this.startPoints[0] === ev.pageX &&\n        _this.startPoints[1] === ev.pageY &&\n        containsClass(ev.target, [\"lightbox-backdrop\", \"lightbox-image\"])\n      ) {\n        _this.props.toggleControls();\n      }\n    }, 200);\n  }\n\n  isInsideImage(ev) {\n    let rect = ReactDOM.findDOMNode(\n      this.refs.container\n    ).getBoundingClientRect();\n    if (\n      ev.pageY < rect.top ||\n      ev.pageY > rect.bottom ||\n      ev.pageX < rect.left ||\n      ev.pageX > rect.right\n    )\n      return false;\n    return true;\n  }\n\n  getEv(ev) {\n    if (\n      ev.type === \"touchstart\" ||\n      ev.type === \"touchmove\" ||\n      ev.type === \"touchend\"\n    )\n      return {\n        pageX: ev.touches[0].pageX,\n        pageY: ev.touches[0].pageY,\n        which: 1,\n        target: ev.target\n      };\n    return ev;\n  }\n\n  renderPDF = () => {\n    const { src } = this.props;\n    return (\n      <div\n        style={{ height: \"100%\" }}\n        dangerouslySetInnerHTML={{\n          __html: `<embed src=${src} type=\"application/pdf\" width=\"100%\" height=\"100%\">`\n        }}\n      />\n    );\n  };\n\n  render() {\n    let [props, state] = [this.props, this.state];\n    let background = `url(${props.src})`;\n    let modifiers, loader;\n    if (props.showImageModifiers) {\n      modifiers = (\n        <ImageModifiers\n          handleRotate={this.handleRotate}\n          handleZoom={this.handleZoom}\n          currentImage={props.src}\n        />\n      );\n    }\n    if (state.loader) {\n      background = \"none\";\n      loader = (\n        <div className=\"lightbox-loader\">\n          <Icon icon=\"spinner\" size={58} />\n        </div>\n      );\n    }\n\n    // const customContent = props.customContent ? props.customContent : null;\n\n    let transform = `rotate(${state.rotate}deg)`;\n    let styles = {\n      height: \"100%\",\n      backgroundImage: isImageUrl(props.src) ? background : \"none\",\n      backgroundRepeat: \"no-repeat\",\n      backgroundSize: `${state.width * state.ratio}px ${state.height *\n        state.ratio}px`,\n      backgroundPosition: `${state.positionX}px ${state.positionY}px`,\n      MsTransform: transform,\n      WebkitTransform: transform,\n      transform: transform\n    };\n\n\n    return (\n      <div className=\"lightbox-content-center\">\n        {modifiers}\n        <div className=\"lightbox-image-container\" ref=\"container\">\n          <div\n            className={\"lightbox-image\" + (state.moving ? \" moving\" : \"\")}\n            style={styles}\n          >\n            {regpPdfHandle(props.src) ? this.renderPDF() : \"文件格式无法展示\"}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nImage.propTypes = {\n  src: PropTypes.string.isRequired,\n  showImageModifiers: PropTypes.bool.isRequired\n};\n"]}]}