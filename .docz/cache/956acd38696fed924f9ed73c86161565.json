{"remainingRequest":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/thread-loader/dist/cjs.js??ref--5-1!/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/babel-loader/lib/index.js??ref--5-2!/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/source-map-loader/index.js!/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/src/components/Image.jsx","dependencies":[{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/src/components/Image.jsx","mtime":1564655739324},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/cache-loader/dist/cjs.js","mtime":1559287157571},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/thread-loader/dist/cjs.js","mtime":1559287161899},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/babel-loader/lib/index.js","mtime":1559287156758},{"path":"/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/node_modules/source-map-loader/index.js","mtime":1559287161728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy9zdXhpYW5nZmVuZy9Eb2N1bWVudHMvc3V4aWFuZ2ZlbmcvbXlQcm9qZWN0L3JlYWN0LWNvbXBvbmVudC9saWdodGJveC1jb21wb25lbnQyL25vZGVfbW9kdWxlcy9iYWJlbC1wcmVzZXQtcmVhY3QtYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiBmcm9tICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQgZnJvbSAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2Fzc2VydFRoaXNJbml0aWFsaXplZCI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKdmFyIF9qc3hGaWxlTmFtZSA9ICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgZW50ZXJNb2R1bGUgPSAodHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsIDogcmVxdWlyZSgncmVhY3QtaG90LWxvYWRlcicpKS5lbnRlck1vZHVsZTsKICBlbnRlck1vZHVsZSAmJiBlbnRlck1vZHVsZShtb2R1bGUpOwp9KSgpOwoKdmFyIF9fc2lnbmF0dXJlX18gPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWxbImRlZmF1bHQiXS5zaWduYXR1cmUgOiBmdW5jdGlvbiAoYSkgewogIHJldHVybiBhOwp9OwoKaW1wb3J0IFJlYWN0IGZyb20gInJlYWN0IjsKaW1wb3J0IFJlYWN0RE9NIGZyb20gInJlYWN0LWRvbSI7CmltcG9ydCBQcm9wVHlwZXMgZnJvbSAicHJvcC10eXBlcyI7CmltcG9ydCBJbWFnZU1vZGlmaWVycyBmcm9tICIuL0ltYWdlTW9kaWZpZXJzIjsKaW1wb3J0IEljb24gZnJvbSAiLi9JY29uIjsKaW1wb3J0IHsgY29udGFpbnNDbGFzcyB9IGZyb20gIi4vdXRpbHMvY2xhc3NOYW1lcyI7CmltcG9ydCAiLi9JbWFnZS5jc3MiOwp2YXIgWk9PTV9TVEVQID0gMS4xOwp2YXIgX3JlZiA9IFtNYXRoLnBvdyhaT09NX1NURVAsIDMwKSwgTWF0aC5wb3coMSAvIFpPT01fU1RFUCwgMTApXSwKICAgIE1BWF9aT09NX1NJWkUgPSBfcmVmWzBdLAogICAgTUlOX1pPT01fU0laRSA9IF9yZWZbMV07Cgp2YXIgcmVncEltYWdlSGFuZGxlID0gZnVuY3Rpb24gcmVncEltYWdlSGFuZGxlKHRleHQpIHsKICByZXR1cm4gL15odHRwcz8uKihnaWZ8cG5nfGpwZT9nfEdJRnxQTkd8SlBFP0cpJC8udGVzdCh0ZXh0KTsKfTsKCnZhciByZWdwUGRmSGFuZGxlID0gZnVuY3Rpb24gcmVncFBkZkhhbmRsZSh0ZXh0KSB7CiAgcmV0dXJuIC9eaHR0cHM/LioocGRmfFBERikkLy50ZXN0KHRleHQpOwp9OwoKdmFyIEltYWdlQ29udGVudCA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoSW1hZ2VDb250ZW50LCBfUmVhY3QkQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gSW1hZ2VDb250ZW50KHByb3BzKSB7CiAgICB2YXIgX3RoaXMyOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbWFnZUNvbnRlbnQpOwoKICAgIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihJbWFnZUNvbnRlbnQpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfdGhpczIucmVuZGVyUERGID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3JjID0gX3RoaXMyLnByb3BzLnNyYzsKICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZTogewogICAgICAgICAgaGVpZ2h0OiAiMTAwJSIKICAgICAgICB9LAogICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7CiAgICAgICAgICBfX2h0bWw6ICI8ZW1iZWQgc3JjPSIuY29uY2F0KHNyYywgIiB0eXBlPVwiYXBwbGljYXRpb24vcGRmXCIgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiPiIpCiAgICAgICAgfSwKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDI2NQogICAgICAgIH0sCiAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgIH0pOwogICAgfTsKCiAgICBfdGhpczIucmVzZXRJbWFnZUluaXRpYWxTdGF0ZSA9IF90aGlzMi5yZXNldEltYWdlSW5pdGlhbFN0YXRlLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5oYW5kbGVXaW5kb3dSZXNpemUgPSBfdGhpczIuaGFuZGxlV2luZG93UmVzaXplLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5oYW5kbGVSb3RhdGUgPSBfdGhpczIuaGFuZGxlUm90YXRlLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5oYW5kbGVab29tID0gX3RoaXMyLmhhbmRsZVpvb20uYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLnNldFpvb21MaW1pdHMgPSBfdGhpczIuc2V0Wm9vbUxpbWl0cy5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSk7CiAgICBfdGhpczIuaGFuZGxlV2hlZWwgPSBfdGhpczIuaGFuZGxlV2hlZWwuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLmhhbmRsZU1vdmUgPSBfdGhpczIuaGFuZGxlTW92ZS5iaW5kKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSk7CiAgICBfdGhpczIuaGFuZGxlTW92ZUVuZCA9IF90aGlzMi5oYW5kbGVNb3ZlRW5kLmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5oYW5kbGVNb3ZlU3RhcnQgPSBfdGhpczIuaGFuZGxlTW92ZVN0YXJ0LmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpKTsKICAgIF90aGlzMi5pc0luc2lkZUltYWdlID0gX3RoaXMyLmlzSW5zaWRlSW1hZ2UuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMikpOwogICAgX3RoaXMyLnN0YXRlID0gewogICAgICBsb2FkZXI6IHRydWUsCiAgICAgIHJhdGlvOiAxLAogICAgICBwb3NpdGlvblg6IDAsCiAgICAgIHBvc2l0aW9uWTogMCwKICAgICAgcm90YXRlOiAwLAogICAgICB3aWR0aDogMCwKICAgICAgaGVpZ2h0OiAwLAogICAgICBib3hXaWR0aDogMCwKICAgICAgYm94SGVpZ2h0OiAwCiAgICB9OwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogIF9jcmVhdGVDbGFzcyhJbWFnZUNvbnRlbnQsIFt7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHRoaXMucmVzZXRJbWFnZUluaXRpYWxTdGF0ZSh0aGlzLnByb3BzKTsKICAgICAgdGhpcy5zdGFydFBvaW50cyA9IG51bGw7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCB0aGlzLmhhbmRsZVdpbmRvd1Jlc2l6ZSk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHRoaXMuaGFuZGxlTW92ZVN0YXJ0KTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2V1cCIsIHRoaXMuaGFuZGxlTW92ZUVuZCk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCB0aGlzLmhhbmRsZU1vdmVTdGFydCk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoZW5kIiwgdGhpcy5oYW5kbGVNb3ZlRW5kKTsKICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpcy5wcm9wcy50b2dnbGVDb250cm9scywgNTAwKTsKCiAgICAgIGlmICh0aGlzLnByb3BzLnNob3dJbWFnZU1vZGlmaWVycykgewogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIHRoaXMuaGFuZGxlTW92ZSk7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIiwgdGhpcy5oYW5kbGVNb3ZlKTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ3aGVlbCIsIHRoaXMuaGFuZGxlV2hlZWwpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5oYW5kbGVXaW5kb3dSZXNpemUpOwogICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCB0aGlzLmhhbmRsZU1vdmVTdGFydCk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIHRoaXMuaGFuZGxlTW92ZSk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNldXAiLCB0aGlzLmhhbmRsZU1vdmVFbmQpOwogICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0IiwgdGhpcy5oYW5kbGVNb3ZlU3RhcnQpOwogICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLCB0aGlzLmhhbmRsZU1vdmUpOwogICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJ0b3VjaGVuZCIsIHRoaXMuaGFuZGxlTW92ZUVuZCk7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIndoZWVsIiwgdGhpcy5oYW5kbGVXaGVlbCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVzZXRJbWFnZUluaXRpYWxTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRJbWFnZUluaXRpYWxTdGF0ZShwcm9wcykgewogICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZjIgPSBbdGhpcy53aWR0aCwgdGhpcy5oZWlnaHRdLAogICAgICAgICAgICB3aWR0aCA9IF9yZWYyWzBdLAogICAgICAgICAgICBoZWlnaHQgPSBfcmVmMlsxXTsKICAgICAgICB2YXIgYm94ID0gUmVhY3RET00uZmluZERPTU5vZGUoX3RoaXMucmVmcy5jb250YWluZXIpOwogICAgICAgIHZhciBfcmVmMyA9IFtib3gub2Zmc2V0V2lkdGgsIGJveC5vZmZzZXRIZWlnaHRdLAogICAgICAgICAgICBib3hXaWR0aCA9IF9yZWYzWzBdLAogICAgICAgICAgICBib3hIZWlnaHQgPSBfcmVmM1sxXTsKICAgICAgICB2YXIgcmF0aW8gPSBNYXRoLm1pbihib3hXaWR0aCAvIHdpZHRoLCBib3hIZWlnaHQgLyBoZWlnaHQpOwogICAgICAgIGlmIChpc05hTihyYXRpbykpIHJhdGlvID0gMTsKCiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgbG9hZGVyOiBmYWxzZSwKICAgICAgICAgIHJhdGlvOiByYXRpbywKICAgICAgICAgIHJvdGF0ZTogMCwKICAgICAgICAgIHBvc2l0aW9uWDogKGJveFdpZHRoIC0gd2lkdGggKiByYXRpbykgLyAyLAogICAgICAgICAgcG9zaXRpb25ZOiAoYm94SGVpZ2h0IC0gaGVpZ2h0ICogcmF0aW8pIC8gMiwKICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLAogICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCwKICAgICAgICAgIGJveFdpZHRoOiBib3hXaWR0aCwKICAgICAgICAgIGJveEhlaWdodDogYm94SGVpZ2h0LAogICAgICAgICAgbW92aW5nOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgaW1nLnNyYyA9IHByb3BzLnNyYzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVXaW5kb3dSZXNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVdpbmRvd1Jlc2l6ZSgpIHsKICAgICAgdGhpcy5yZXNldEltYWdlSW5pdGlhbFN0YXRlKHRoaXMucHJvcHMpOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZVJvdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlUm90YXRlKGFuZ2xlKSB7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHJvdGF0ZTogKDM2MCArIHRoaXMuc3RhdGUucm90YXRlICsgYW5nbGUpICUgMzYwCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZVpvb20iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVpvb20oZGlyZWN0aW9uLCBzY2FsZSkgewogICAgICBpZiAoIXNjYWxlKSBzY2FsZSA9IDE7CiAgICAgIHZhciBwZXJjZW50ID0gZGlyZWN0aW9uID4gMCA/IE1hdGgucG93KFpPT01fU1RFUCwgc2NhbGUpIDogTWF0aC5wb3coMSAvIFpPT01fU1RFUCwgc2NhbGUpOwogICAgICB2YXIgcmF0aW8gPSB0aGlzLnNldFpvb21MaW1pdHModGhpcy5zdGF0ZS5yYXRpbyAqIHBlcmNlbnQpOwogICAgICB2YXIgc3RhdGUgPSB0aGlzLnN0YXRlOwogICAgICB2YXIgZGVsdGEgPSAwLjA1OwogICAgICB2YXIgbmV3UG9zaXRpb25YLCBuZXdQb3NpdGlvblk7CgogICAgICBpZiAoTWF0aC5taW4oc3RhdGUuYm94V2lkdGggLyBzdGF0ZS53aWR0aCwgc3RhdGUuYm94SGVpZ2h0IC8gc3RhdGUuaGVpZ2h0KSA+PSByYXRpbyAtIGRlbHRhKSB7CiAgICAgICAgbmV3UG9zaXRpb25YID0gKHN0YXRlLmJveFdpZHRoIC0gc3RhdGUud2lkdGggKiByYXRpbykgLyAyOwogICAgICAgIG5ld1Bvc2l0aW9uWSA9IChzdGF0ZS5ib3hIZWlnaHQgLSBzdGF0ZS5oZWlnaHQgKiByYXRpbykgLyAyOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENlbnRlciBpbWFnZSBmcm9tIGNvbnRhaW5lcidzIGNlbnRlcgogICAgICAgIHZhciBvZmZzZXRYID0gc3RhdGUuYm94V2lkdGggLyAyOwogICAgICAgIHZhciBvZmZzZXRZID0gc3RhdGUuYm94SGVpZ2h0IC8gMjsKICAgICAgICB2YXIgYmdDdXJzb3JYID0gb2Zmc2V0WCAtIHN0YXRlLnBvc2l0aW9uWDsKICAgICAgICB2YXIgYmdDdXJzb3JZID0gb2Zmc2V0WSAtIHN0YXRlLnBvc2l0aW9uWTsKICAgICAgICB2YXIgYmdSYXRpb1ggPSBiZ0N1cnNvclggLyAoc3RhdGUud2lkdGggKiBzdGF0ZS5yYXRpbyk7CiAgICAgICAgdmFyIGJnUmF0aW9ZID0gYmdDdXJzb3JZIC8gKHN0YXRlLmhlaWdodCAqIHN0YXRlLnJhdGlvKTsKICAgICAgICBuZXdQb3NpdGlvblggPSBvZmZzZXRYIC0gc3RhdGUud2lkdGggKiByYXRpbyAqIGJnUmF0aW9YOwogICAgICAgIG5ld1Bvc2l0aW9uWSA9IG9mZnNldFkgLSBzdGF0ZS5oZWlnaHQgKiByYXRpbyAqIGJnUmF0aW9ZOwogICAgICB9CgogICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICByYXRpbzogcmF0aW8sCiAgICAgICAgcG9zaXRpb25YOiBuZXdQb3NpdGlvblgsCiAgICAgICAgcG9zaXRpb25ZOiBuZXdQb3NpdGlvblkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Wm9vbUxpbWl0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Wm9vbUxpbWl0cyhzaXplKSB7CiAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGU7CiAgICAgIHZhciBvcmlnaW5hbFJhdGlvID0gTWF0aC5taW4oc3RhdGUuYm94V2lkdGggLyBzdGF0ZS53aWR0aCwgc3RhdGUuYm94SGVpZ2h0IC8gc3RhdGUuaGVpZ2h0KTsKICAgICAgaWYgKHNpemUgLyBvcmlnaW5hbFJhdGlvID4gTUFYX1pPT01fU0laRSkgcmV0dXJuIE1BWF9aT09NX1NJWkUgKiBvcmlnaW5hbFJhdGlvO2Vsc2UgaWYgKHNpemUgLyBvcmlnaW5hbFJhdGlvIDwgTUlOX1pPT01fU0laRSkgcmV0dXJuIE1JTl9aT09NX1NJWkUgKiBvcmlnaW5hbFJhdGlvO2Vsc2UgcmV0dXJuIHNpemU7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFuZGxlV2hlZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVdoZWVsKGV2KSB7CiAgICAgIGlmICh0aGlzLmlzSW5zaWRlSW1hZ2UoZXYpKSB0aGlzLmhhbmRsZVpvb20oZXYuZGVsdGFZKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVNb3ZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVNb3ZlKGV2KSB7CiAgICAgIGV2ID0gdGhpcy5nZXRFdihldik7CiAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGU7CiAgICAgIGlmICghc3RhdGUubW92aW5nKSByZXR1cm47CiAgICAgIHZhciBwb3NYLCBwb3NZOwoKICAgICAgc3dpdGNoIChzdGF0ZS5yb3RhdGUpIHsKICAgICAgICBjYXNlIDkwOgogICAgICAgICAgcG9zWSA9IHRoaXMuc3RhcnRQb2ludHNbMF0gLSBldi5wYWdlWDsKICAgICAgICAgIHBvc1ggPSBldi5wYWdlWSAtIHRoaXMuc3RhcnRQb2ludHNbMV07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxODA6CiAgICAgICAgICBwb3NYID0gdGhpcy5zdGFydFBvaW50c1swXSAtIGV2LnBhZ2VYOwogICAgICAgICAgcG9zWSA9IHRoaXMuc3RhcnRQb2ludHNbMV0gLSBldi5wYWdlWTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI3MDoKICAgICAgICAgIHBvc1kgPSBldi5wYWdlWCAtIHRoaXMuc3RhcnRQb2ludHNbMF07CiAgICAgICAgICBwb3NYID0gdGhpcy5zdGFydFBvaW50c1sxXSAtIGV2LnBhZ2VZOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBwb3NYID0gZXYucGFnZVggLSB0aGlzLnN0YXJ0UG9pbnRzWzBdOwogICAgICAgICAgcG9zWSA9IGV2LnBhZ2VZIC0gdGhpcy5zdGFydFBvaW50c1sxXTsKICAgICAgfQoKICAgICAgdGhpcy5zdGFydFBvaW50cyA9IFtldi5wYWdlWCwgZXYucGFnZVldOwogICAgICBpZiAoc3RhdGUucG9zaXRpb25YICsgcG9zWCA+PSAwIHx8IHN0YXRlLnBvc2l0aW9uWCArIHBvc1ggPD0gc3RhdGUuYm94V2lkdGggLSBzdGF0ZS53aWR0aCAqIHN0YXRlLnJhdGlvKSBwb3NYID0gMDsKICAgICAgaWYgKHN0YXRlLnBvc2l0aW9uWSArIHBvc1kgPj0gMCB8fCBzdGF0ZS5wb3NpdGlvblkgKyBwb3NZIDw9IHN0YXRlLmJveEhlaWdodCAtIHN0YXRlLmhlaWdodCAqIHN0YXRlLnJhdGlvKSBwb3NZID0gMDsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcG9zaXRpb25YOiBzdGF0ZS5wb3NpdGlvblggKyBwb3NYLAogICAgICAgIHBvc2l0aW9uWTogc3RhdGUucG9zaXRpb25ZICsgcG9zWQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVNb3ZlRW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVNb3ZlRW5kKGV2KSB7CiAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIG1vdmluZzogZmFsc2UKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFuZGxlTW92ZVN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVNb3ZlU3RhcnQoZXYpIHsKICAgICAgZXYgPSB0aGlzLmdldEV2KGV2KTsKICAgICAgaWYgKCF0aGlzLmlzSW5zaWRlSW1hZ2UoZXYpIHx8IGV2LndoaWNoICE9PSAxKSByZXR1cm47CiAgICAgIHRoaXMuc3RhcnRQb2ludHMgPSBbZXYucGFnZVgsIGV2LnBhZ2VZXTsKICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgbW92aW5nOiB0cnVlCiAgICAgIH0pOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsgLy8gY2hlY2sgaWYgdG91Y2ggd2FzIGEgdGFwCgoKICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghX3RoaXMuc3RhdGUubW92aW5nICYmIF90aGlzLnN0YXJ0UG9pbnRzICYmIF90aGlzLnN0YXJ0UG9pbnRzWzBdID09PSBldi5wYWdlWCAmJiBfdGhpcy5zdGFydFBvaW50c1sxXSA9PT0gZXYucGFnZVkgJiYgY29udGFpbnNDbGFzcyhldi50YXJnZXQsIFsibGlnaHRib3gtYmFja2Ryb3AiLCAibGlnaHRib3gtaW1hZ2UiXSkpIHsKICAgICAgICAgIF90aGlzLnByb3BzLnRvZ2dsZUNvbnRyb2xzKCk7CiAgICAgICAgfQogICAgICB9LCAyMDApOwogICAgfQogIH0sIHsKICAgIGtleTogImlzSW5zaWRlSW1hZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzSW5zaWRlSW1hZ2UoZXYpIHsKICAgICAgdmFyIHJlY3QgPSBSZWFjdERPTS5maW5kRE9NTm9kZSh0aGlzLnJlZnMuY29udGFpbmVyKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKGV2LnBhZ2VZIDwgcmVjdC50b3AgfHwgZXYucGFnZVkgPiByZWN0LmJvdHRvbSB8fCBldi5wYWdlWCA8IHJlY3QubGVmdCB8fCBldi5wYWdlWCA+IHJlY3QucmlnaHQpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RXYiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEV2KGV2KSB7CiAgICAgIGlmIChldi50eXBlID09PSAidG91Y2hzdGFydCIgfHwgZXYudHlwZSA9PT0gInRvdWNobW92ZSIgfHwgZXYudHlwZSA9PT0gInRvdWNoZW5kIikgcmV0dXJuIHsKICAgICAgICBwYWdlWDogZXYudG91Y2hlc1swXS5wYWdlWCwKICAgICAgICBwYWdlWTogZXYudG91Y2hlc1swXS5wYWdlWSwKICAgICAgICB3aGljaDogMSwKICAgICAgICB0YXJnZXQ6IGV2LnRhcmdldAogICAgICB9OwogICAgICByZXR1cm4gZXY7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfcmVmNCA9IFt0aGlzLnByb3BzLCB0aGlzLnN0YXRlXSwKICAgICAgICAgIHByb3BzID0gX3JlZjRbMF0sCiAgICAgICAgICBzdGF0ZSA9IF9yZWY0WzFdOwogICAgICB2YXIgYmFja2dyb3VuZCA9ICJ1cmwoIi5jb25jYXQocHJvcHMuc3JjLCAiKSIpOwogICAgICB2YXIgbW9kaWZpZXJzLCBsb2FkZXI7CgogICAgICBpZiAocHJvcHMuc2hvd0ltYWdlTW9kaWZpZXJzKSB7CiAgICAgICAgbW9kaWZpZXJzID0gUmVhY3QuY3JlYXRlRWxlbWVudChJbWFnZU1vZGlmaWVycywgewogICAgICAgICAgaGFuZGxlUm90YXRlOiB0aGlzLmhhbmRsZVJvdGF0ZSwKICAgICAgICAgIGhhbmRsZVpvb206IHRoaXMuaGFuZGxlWm9vbSwKICAgICAgICAgIGN1cnJlbnRJbWFnZTogcHJvcHMuc3JjLAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogMjgwCiAgICAgICAgICB9LAogICAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChzdGF0ZS5sb2FkZXIpIHsKICAgICAgICBiYWNrZ3JvdW5kID0gIm5vbmUiOwogICAgICAgIGxvYWRlciA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImxpZ2h0Ym94LWxvYWRlciIsCiAgICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgICBsaW5lTnVtYmVyOiAyOTAKICAgICAgICAgIH0sCiAgICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgICB9LCBSZWFjdC5jcmVhdGVFbGVtZW50KEljb24sIHsKICAgICAgICAgIGljb246ICJzcGlubmVyIiwKICAgICAgICAgIHNpemU6IDU4LAogICAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgICAgbGluZU51bWJlcjogMjkxCiAgICAgICAgICB9LAogICAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgICAgfSkpOwogICAgICB9IC8vIGNvbnN0IGN1c3RvbUNvbnRlbnQgPSBwcm9wcy5jdXN0b21Db250ZW50ID8gcHJvcHMuY3VzdG9tQ29udGVudCA6IG51bGw7CgoKICAgICAgdmFyIHRyYW5zZm9ybSA9ICJyb3RhdGUoIi5jb25jYXQoc3RhdGUucm90YXRlLCAiZGVnKSIpOwogICAgICB2YXIgc3R5bGVzID0gewogICAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICAgIGJhY2tncm91bmRJbWFnZTogcmVncEltYWdlSGFuZGxlKHByb3BzLnNyYykgPyBiYWNrZ3JvdW5kIDogIm5vbmUiLAogICAgICAgIGJhY2tncm91bmRSZXBlYXQ6ICJuby1yZXBlYXQiLAogICAgICAgIGJhY2tncm91bmRTaXplOiAiIi5jb25jYXQoc3RhdGUud2lkdGggKiBzdGF0ZS5yYXRpbywgInB4ICIpLmNvbmNhdChzdGF0ZS5oZWlnaHQgKiBzdGF0ZS5yYXRpbywgInB4IiksCiAgICAgICAgYmFja2dyb3VuZFBvc2l0aW9uOiAiIi5jb25jYXQoc3RhdGUucG9zaXRpb25YLCAicHggIikuY29uY2F0KHN0YXRlLnBvc2l0aW9uWSwgInB4IiksCiAgICAgICAgTXNUcmFuc2Zvcm06IHRyYW5zZm9ybSwKICAgICAgICBXZWJraXRUcmFuc2Zvcm06IHRyYW5zZm9ybSwKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zZm9ybQogICAgICB9OwogICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImxpZ2h0Ym94LWNvbnRlbnQtY2VudGVyIiwKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDMxMgogICAgICAgIH0sCiAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgIH0sIG1vZGlmaWVycywgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImxpZ2h0Ym94LWltYWdlLWNvbnRhaW5lciIsCiAgICAgICAgcmVmOiAiY29udGFpbmVyIiwKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDMxNAogICAgICAgIH0sCiAgICAgICAgX19zZWxmOiB0aGlzCiAgICAgIH0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJsaWdodGJveC1pbWFnZSIgKyAoc3RhdGUubW92aW5nID8gIiBtb3ZpbmciIDogIiIpLAogICAgICAgIHN0eWxlOiBzdHlsZXMsCiAgICAgICAgX19zb3VyY2U6IHsKICAgICAgICAgIGZpbGVOYW1lOiBfanN4RmlsZU5hbWUsCiAgICAgICAgICBsaW5lTnVtYmVyOiAzMTUKICAgICAgICB9LAogICAgICAgIF9fc2VsZjogdGhpcwogICAgICB9LCByZWdwUGRmSGFuZGxlKHByb3BzLnNyYykgPyB0aGlzLnJlbmRlclBERigpIDogbG9hZGVyKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9fcmVhY3RzdGFuZGluX19yZWdlbmVyYXRlQnlFdmFsIiwKICAgIC8vIEB0cy1pZ25vcmUKICAgIHZhbHVlOiBmdW5jdGlvbiBfX3JlYWN0c3RhbmRpbl9fcmVnZW5lcmF0ZUJ5RXZhbChrZXksIGNvZGUpIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICB0aGlzW2tleV0gPSBldmFsKGNvZGUpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEltYWdlQ29udGVudDsKfShSZWFjdC5Db21wb25lbnQpOwoKZXhwb3J0IHsgSW1hZ2VDb250ZW50IGFzIGRlZmF1bHQgfTsKCmlmICh0eXBlb2YgSW1hZ2VDb250ZW50ICE9PSAndW5kZWZpbmVkJyAmJiBJbWFnZUNvbnRlbnQgJiYgSW1hZ2VDb250ZW50ID09PSBPYmplY3QoSW1hZ2VDb250ZW50KSAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKEltYWdlQ29udGVudCkpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VDb250ZW50LCAnX19maWxlbWV0YScsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICB2YWx1ZTogewogICAgICBuYW1lOiAiSW1hZ2VDb250ZW50IiwKICAgICAgZmlsZW5hbWU6ICJzcmMvY29tcG9uZW50cy9JbWFnZS5qc3giCiAgICB9CiAgfSk7Cn0KCmlmICh0eXBlb2YgSW1hZ2VDb250ZW50ICE9PSAndW5kZWZpbmVkJyAmJiBJbWFnZUNvbnRlbnQgJiYgSW1hZ2VDb250ZW50ID09PSBPYmplY3QoSW1hZ2VDb250ZW50KSAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKEltYWdlQ29udGVudCkpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VDb250ZW50LCAnX19maWxlbWV0YScsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICB2YWx1ZTogewogICAgICBuYW1lOiAiSW1hZ2VDb250ZW50IiwKICAgICAgZmlsZW5hbWU6ICJzcmMvY29tcG9uZW50cy9JbWFnZS5qc3giCiAgICB9CiAgfSk7Cn0KCkltYWdlLnByb3BUeXBlcyA9IHsKICBzcmM6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCwKICBzaG93SW1hZ2VNb2RpZmllcnM6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQKfTsKOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgcmVhY3RIb3RMb2FkZXIgPSAodHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsIDogcmVxdWlyZSgncmVhY3QtaG90LWxvYWRlcicpKS5kZWZhdWx0OwoKICBpZiAoIXJlYWN0SG90TG9hZGVyKSB7CiAgICByZXR1cm47CiAgfQoKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihaT09NX1NURVAsICJaT09NX1NURVAiLCAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvc3JjL2NvbXBvbmVudHMvSW1hZ2UuanN4Iik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoTUFYX1pPT01fU0laRSwgIk1BWF9aT09NX1NJWkUiLCAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvc3JjL2NvbXBvbmVudHMvSW1hZ2UuanN4Iik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoTUlOX1pPT01fU0laRSwgIk1JTl9aT09NX1NJWkUiLCAiL1VzZXJzL3N1eGlhbmdmZW5nL0RvY3VtZW50cy9zdXhpYW5nZmVuZy9teVByb2plY3QvcmVhY3QtY29tcG9uZW50L2xpZ2h0Ym94LWNvbXBvbmVudDIvc3JjL2NvbXBvbmVudHMvSW1hZ2UuanN4Iik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIocmVncEltYWdlSGFuZGxlLCAicmVncEltYWdlSGFuZGxlIiwgIi9Vc2Vycy9zdXhpYW5nZmVuZy9Eb2N1bWVudHMvc3V4aWFuZ2ZlbmcvbXlQcm9qZWN0L3JlYWN0LWNvbXBvbmVudC9saWdodGJveC1jb21wb25lbnQyL3NyYy9jb21wb25lbnRzL0ltYWdlLmpzeCIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKHJlZ3BQZGZIYW5kbGUsICJyZWdwUGRmSGFuZGxlIiwgIi9Vc2Vycy9zdXhpYW5nZmVuZy9Eb2N1bWVudHMvc3V4aWFuZ2ZlbmcvbXlQcm9qZWN0L3JlYWN0LWNvbXBvbmVudC9saWdodGJveC1jb21wb25lbnQyL3NyYy9jb21wb25lbnRzL0ltYWdlLmpzeCIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKEltYWdlQ29udGVudCwgIkltYWdlQ29udGVudCIsICIvVXNlcnMvc3V4aWFuZ2ZlbmcvRG9jdW1lbnRzL3N1eGlhbmdmZW5nL215UHJvamVjdC9yZWFjdC1jb21wb25lbnQvbGlnaHRib3gtY29tcG9uZW50Mi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gKHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbCA6IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKSkubGVhdmVNb2R1bGU7CiAgbGVhdmVNb2R1bGUgJiYgbGVhdmVNb2R1bGUobW9kdWxlKTsKfSkoKTs="},{"version":3,"sources":["/Users/suxiangfeng/Documents/suxiangfeng/myProject/react-component/lightbox-component2/src/components/Image.jsx"],"names":["React","ReactDOM","PropTypes","ImageModifiers","Icon","containsClass","ZOOM_STEP","Math","pow","MAX_ZOOM_SIZE","MIN_ZOOM_SIZE","regpImageHandle","text","test","regpPdfHandle","ImageContent","props","renderPDF","src","height","__html","resetImageInitialState","bind","handleWindowResize","handleRotate","handleZoom","setZoomLimits","handleWheel","handleMove","handleMoveEnd","handleMoveStart","isInsideImage","state","loader","ratio","positionX","positionY","rotate","width","boxWidth","boxHeight","startPoints","window","addEventListener","document","setTimeout","toggleControls","showImageModifiers","removeEventListener","img","Image","_this","onload","box","findDOMNode","refs","container","offsetWidth","offsetHeight","min","isNaN","setState","moving","angle","direction","scale","percent","delta","newPositionX","newPositionY","offsetX","offsetY","bgCursorX","bgCursorY","bgRatioX","bgRatioY","size","originalRatio","ev","deltaY","getEv","posX","posY","pageX","pageY","which","target","rect","getBoundingClientRect","top","bottom","left","right","type","touches","background","modifiers","transform","styles","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition","MsTransform","WebkitTransform","Component","propTypes","string","isRequired","bool"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport ImageModifiers from \"./ImageModifiers\";\nimport Icon from \"./Icon\";\nimport { containsClass } from \"./utils/classNames\";\nimport \"./Image.css\";\n\nconst ZOOM_STEP = 1.1;\nconst [MAX_ZOOM_SIZE, MIN_ZOOM_SIZE] = [\n  Math.pow(ZOOM_STEP, 30),\n  Math.pow(1 / ZOOM_STEP, 10)\n];\n\nconst regpImageHandle = text =>\n  /^https?.*(gif|png|jpe?g|GIF|PNG|JPE?G)$/.test(text);\nconst regpPdfHandle = text => /^https?.*(pdf|PDF)$/.test(text);\n\nexport default class ImageContent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.resetImageInitialState = this.resetImageInitialState.bind(this);\n    this.handleWindowResize = this.handleWindowResize.bind(this);\n    this.handleRotate = this.handleRotate.bind(this);\n    this.handleZoom = this.handleZoom.bind(this);\n    this.setZoomLimits = this.setZoomLimits.bind(this);\n    this.handleWheel = this.handleWheel.bind(this);\n    this.handleMove = this.handleMove.bind(this);\n    this.handleMoveEnd = this.handleMoveEnd.bind(this);\n    this.handleMoveStart = this.handleMoveStart.bind(this);\n    this.isInsideImage = this.isInsideImage.bind(this);\n    this.state = {\n      loader: true,\n      ratio: 1,\n      positionX: 0,\n      positionY: 0,\n      rotate: 0,\n      width: 0,\n      height: 0,\n      boxWidth: 0,\n      boxHeight: 0\n    };\n  }\n\n  componentDidMount() {\n    this.resetImageInitialState(this.props);\n    this.startPoints = null;\n    window.addEventListener(\"resize\", this.handleWindowResize);\n    document.addEventListener(\"mousedown\", this.handleMoveStart);\n    document.addEventListener(\"mouseup\", this.handleMoveEnd);\n    document.addEventListener(\"touchstart\", this.handleMoveStart);\n    document.addEventListener(\"touchend\", this.handleMoveEnd);\n    window.setTimeout(this.props.toggleControls, 500);\n    if (this.props.showImageModifiers) {\n      document.addEventListener(\"mousemove\", this.handleMove);\n      document.addEventListener(\"touchmove\", this.handleMove);\n      document.addEventListener(\"wheel\", this.handleWheel);\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.handleWindowResize);\n    document.removeEventListener(\"mousedown\", this.handleMoveStart);\n    document.removeEventListener(\"mousemove\", this.handleMove);\n    document.removeEventListener(\"mouseup\", this.handleMoveEnd);\n    document.removeEventListener(\"touchstart\", this.handleMoveStart);\n    document.removeEventListener(\"touchmove\", this.handleMove);\n    document.removeEventListener(\"touchend\", this.handleMoveEnd);\n    document.removeEventListener(\"wheel\", this.handleWheel);\n  }\n\n  resetImageInitialState(props) {\n    let img = new Image();\n    let _this = this;\n    img.onload = function() {\n      let [width, height] = [this.width, this.height];\n      let box = ReactDOM.findDOMNode(_this.refs.container);\n      let [boxWidth, boxHeight] = [box.offsetWidth, box.offsetHeight];\n      let ratio = Math.min(boxWidth / width, boxHeight / height);\n      if (isNaN(ratio)) ratio = 1;\n      _this.setState({\n        loader: false,\n        ratio: ratio,\n        rotate: 0,\n        positionX: (boxWidth - width * ratio) / 2,\n        positionY: (boxHeight - height * ratio) / 2,\n        width: this.width,\n        height: this.height,\n        boxWidth: boxWidth,\n        boxHeight: boxHeight,\n        moving: false\n      });\n    };\n    img.src = props.src;\n  }\n\n  handleWindowResize() {\n    this.resetImageInitialState(this.props);\n  }\n\n  handleRotate(angle) {\n    this.setState({\n      rotate: (360 + this.state.rotate + angle) % 360\n    });\n  }\n\n  handleZoom(direction, scale) {\n    if (!scale) scale = 1;\n    let percent =\n      direction > 0\n        ? Math.pow(ZOOM_STEP, scale)\n        : Math.pow(1 / ZOOM_STEP, scale);\n    let ratio = this.setZoomLimits(this.state.ratio * percent);\n    let state = this.state;\n    let delta = 0.05;\n    let newPositionX, newPositionY;\n\n    if (\n      Math.min(state.boxWidth / state.width, state.boxHeight / state.height) >=\n      ratio - delta\n    ) {\n      newPositionX = (state.boxWidth - state.width * ratio) / 2;\n      newPositionY = (state.boxHeight - state.height * ratio) / 2;\n    } else {\n      // Center image from container's center\n      let offsetX = state.boxWidth / 2;\n      let offsetY = state.boxHeight / 2;\n\n      let bgCursorX = offsetX - state.positionX;\n      let bgCursorY = offsetY - state.positionY;\n\n      let bgRatioX = bgCursorX / (state.width * state.ratio);\n      let bgRatioY = bgCursorY / (state.height * state.ratio);\n\n      newPositionX = offsetX - state.width * ratio * bgRatioX;\n      newPositionY = offsetY - state.height * ratio * bgRatioY;\n    }\n\n    this.setState({\n      ratio: ratio,\n      positionX: newPositionX,\n      positionY: newPositionY\n    });\n  }\n\n  setZoomLimits(size) {\n    let state = this.state;\n    let originalRatio = Math.min(\n      state.boxWidth / state.width,\n      state.boxHeight / state.height\n    );\n    if (size / originalRatio > MAX_ZOOM_SIZE)\n      return MAX_ZOOM_SIZE * originalRatio;\n    else if (size / originalRatio < MIN_ZOOM_SIZE)\n      return MIN_ZOOM_SIZE * originalRatio;\n    else return size;\n  }\n\n  handleWheel(ev) {\n    if (this.isInsideImage(ev)) this.handleZoom(ev.deltaY);\n  }\n\n  handleMove(ev) {\n    ev = this.getEv(ev);\n    let state = this.state;\n    if (!state.moving) return;\n    let posX, posY;\n    switch (state.rotate) {\n      case 90:\n        posY = this.startPoints[0] - ev.pageX;\n        posX = ev.pageY - this.startPoints[1];\n        break;\n      case 180:\n        posX = this.startPoints[0] - ev.pageX;\n        posY = this.startPoints[1] - ev.pageY;\n        break;\n      case 270:\n        posY = ev.pageX - this.startPoints[0];\n        posX = this.startPoints[1] - ev.pageY;\n        break;\n      default:\n        posX = ev.pageX - this.startPoints[0];\n        posY = ev.pageY - this.startPoints[1];\n    }\n    this.startPoints = [ev.pageX, ev.pageY];\n\n    if (\n      state.positionX + posX >= 0 ||\n      state.positionX + posX <= state.boxWidth - state.width * state.ratio\n    )\n      posX = 0;\n    if (\n      state.positionY + posY >= 0 ||\n      state.positionY + posY <= state.boxHeight - state.height * state.ratio\n    )\n      posY = 0;\n\n    this.setState({\n      positionX: state.positionX + posX,\n      positionY: state.positionY + posY\n    });\n  }\n\n  handleMoveEnd(ev) {\n    this.setState({\n      moving: false\n    });\n  }\n\n  handleMoveStart(ev) {\n    ev = this.getEv(ev);\n    if (!this.isInsideImage(ev) || ev.which !== 1) return;\n    this.startPoints = [ev.pageX, ev.pageY];\n    this.setState({\n      moving: true\n    });\n    const _this = this;\n\n    // check if touch was a tap\n    window.setTimeout(function() {\n      if (\n        !_this.state.moving &&\n        _this.startPoints &&\n        _this.startPoints[0] === ev.pageX &&\n        _this.startPoints[1] === ev.pageY &&\n        containsClass(ev.target, [\"lightbox-backdrop\", \"lightbox-image\"])\n      ) {\n        _this.props.toggleControls();\n      }\n    }, 200);\n  }\n\n  isInsideImage(ev) {\n    let rect = ReactDOM.findDOMNode(\n      this.refs.container\n    ).getBoundingClientRect();\n    if (\n      ev.pageY < rect.top ||\n      ev.pageY > rect.bottom ||\n      ev.pageX < rect.left ||\n      ev.pageX > rect.right\n    )\n      return false;\n    return true;\n  }\n\n  getEv(ev) {\n    if (\n      ev.type === \"touchstart\" ||\n      ev.type === \"touchmove\" ||\n      ev.type === \"touchend\"\n    )\n      return {\n        pageX: ev.touches[0].pageX,\n        pageY: ev.touches[0].pageY,\n        which: 1,\n        target: ev.target\n      };\n    return ev;\n  }\n\n  renderPDF = () => {\n    const { src } = this.props;\n    return (\n      <div\n        style={{ height: \"100%\" }}\n        dangerouslySetInnerHTML={{\n          __html: `<embed src=${src} type=\"application/pdf\" width=\"100%\" height=\"100%\">`\n        }}\n      />\n    );\n  };\n\n  render() {\n    let [props, state] = [this.props, this.state];\n    let background = `url(${props.src})`;\n    let modifiers, loader;\n    if (props.showImageModifiers) {\n      modifiers = (\n        <ImageModifiers\n          handleRotate={this.handleRotate}\n          handleZoom={this.handleZoom}\n          currentImage={props.src}\n        />\n      );\n    }\n    if (state.loader) {\n      background = \"none\";\n      loader = (\n        <div className=\"lightbox-loader\">\n          <Icon icon=\"spinner\" size={58} />\n        </div>\n      );\n    }\n\n    // const customContent = props.customContent ? props.customContent : null;\n\n    let transform = `rotate(${state.rotate}deg)`;\n    let styles = {\n      height: \"100%\",\n      backgroundImage: regpImageHandle(props.src) ? background : \"none\",\n      backgroundRepeat: \"no-repeat\",\n      backgroundSize: `${state.width * state.ratio}px ${state.height *\n        state.ratio}px`,\n      backgroundPosition: `${state.positionX}px ${state.positionY}px`,\n      MsTransform: transform,\n      WebkitTransform: transform,\n      transform: transform\n    };\n\n    return (\n      <div className=\"lightbox-content-center\">\n        {modifiers}\n        <div className=\"lightbox-image-container\" ref=\"container\">\n          <div\n            className={\"lightbox-image\" + (state.moving ? \" moving\" : \"\")}\n            style={styles}\n          >\n            {regpPdfHandle(props.src) ? this.renderPDF() : loader}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nImage.propTypes = {\n  src: PropTypes.string.isRequired,\n  showImageModifiers: PropTypes.bool.isRequired\n};\n"]}]}